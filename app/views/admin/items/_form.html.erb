<%# app/views/admin/items/_form.html.erb %>
<div class="item-card item-card--form">
  <%= form_with(model: [:admin, item], local: true) do |f| %>
    
    <% if item.errors.any? %>
      <div class="form-errors">
        <h4>–ü–æ–º–∏–ª–∫–∏ –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ:</h4>
        <ul>
          <% item.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>
    <div class="form-row">
      <%= f.label :image, "–§–û–¢–û –¢–û–í–ê–†–£ üì∏", class: "form-label" %>
      <%= f.file_field :image, class: "form-control" %>
    </div>

    <% if item.image.attached? %>
      <div class="form-row">
        <p class="muted">–ü–æ—Ç–æ—á–Ω–µ —Ñ–æ—Ç–æ:</p>
        <%= image_tag @item.image.variant(resize_to_limit: [200, 200]), class: "item-thumb" %>
      </div>
    <% end %>
    <div class="form-grid">
      <div class="form-group form-group--full">
        <%= f.label :name, "–ù–∞–∑–≤–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É", class: "form-label" %>
        <%= f.text_field :name, class: "form-control" %>
      </div>

      <div class="form-group">
        <%= f.label :price, "–¶—ñ–Ω–∞ (‚Ç¥)", class: "form-label" %>
        <%= f.number_field :price, step: 0.01, class: "form-control" %>
      </div>

      <div class="form-group">
        <%= f.label :quantity, "–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–∞ —Å–∫–ª–∞–¥—ñ", class: "form-label" %>
        <%= f.number_field :quantity, class: "form-control" %>
      </div>

      <div class="form-group form-group--full">
        <%= f.label :description, "–û–ø–∏—Å", class: "form-label" %>
        <%= f.text_area :description, rows: 6, class: "form-control" %>
      </div>

      <div class="form-group form-group--full">
        <label class="form-label">–¢–µ–≥–∏ —Ç–∞ –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó</label>
        <div class="tags-grid">
          <%= f.collection_check_boxes :tag_ids, Tag.all, :id, :name do |b| %>
            <label style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem; cursor: pointer;">
              <%= b.check_box %>
              <%= b.label %>
            </label>
          <% end %>
        </div>
      </div>
    </div>

    <div style="margin-top: 30px; display: flex; gap: 15px;">
      <%= f.submit item.new_record? ? "–°–¢–í–û–†–ò–¢–ò –¢–û–í–ê–† ü§ò" : "–û–ù–û–í–ò–¢–ò –¢–û–í–ê–† ‚ú®", class: "btn-primary", style: "flex: 2; padding: 15px;" %>
      <%= link_to "–°–ö–ê–°–£–í–ê–¢–ò", admin_items_path, class: "btn-outline" %>
    </div>
  <% end %>
</div>