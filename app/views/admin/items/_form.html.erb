<div class="max-w-4xl mx-auto">
  <div class="bg-stone-900 p-6 md:p-10 rounded-2xl border border-stone-800 shadow-2xl">
      <%= form_with(model: [:admin, item], local: true, html: { multipart: true, class: "space-y-8" }) do |f| %>      
      <% if item.errors.any? %>
        <div class="bg-red-900/20 border-l-4 border-red-500 p-5 rounded-r-xl animate-shake">
          <h4 class="text-red-500 font-black uppercase text-sm mb-2">–ü–æ–º–∏–ª–∫–∏ –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ:</h4>
          <ul class="list-disc list-inside text-stone-400 text-xs space-y-1">
            <% item.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="space-y-4">
        <%= f.label :image, class: "block text-primary font-black uppercase tracking-widest text-xs mb-2" do %>
          –§–û–¢–û –¢–û–í–ê–†–£ üì∏
        <% end %>
        
          <% if item.image.attached? && item.persisted? %>
            <div class="shrink-0">
              <%= image_tag item.image.variant(resize_to_limit: [150, 150]), 
                  class: "rounded-lg border-2 border-primary shadow-lg shadow-primary/20" %>
            </div>
          <% elsif item.image.attached? %>
            <div class="shrink-0 flex flex-col items-center gap-2">
              <div class="w-32 h-32 bg-stone-800 rounded-lg border-2 border-primary flex items-center justify-center text-xs text-center p-2 text-stone-300">
                –§–æ—Ç–æ –≥–æ—Ç–æ–≤–µ –¥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è üì•
              </div>
            </div>
          <% else %>
            <div class="w-32 h-32 bg-stone-900 rounded-lg border-2 border-stone-800 flex items-center justify-center text-4xl grayscale opacity-30">
              üé∏
            </div>
          <% end %>
          
          <div class="flex-1 w-full">
            <%= f.file_field :image, class: "block w-full text-xs text-stone-400
              file:mr-4 file:py-2 file:px-4
              file:rounded-full file:border-0
              file:text-xs file:font-black
              file:bg-primary file:text-white
              hover:file:bg-primary-dark cursor-pointer" %>
            <p class="mt-2 text-[10px] text-stone-500 italic">–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ: –∫–≤–∞–¥—Ä–∞—Ç–Ω–µ —Ñ–æ—Ç–æ, –¥–æ 5MB</p>
          </div>
        </div>
      </div>

      <%# –û–°–ù–û–í–ù–ê –°–Ü–¢–ö–ê –ü–û–õ–Ü–í %>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        
        <div class="md:col-span-2">
          <%= f.label :name, "–ù–∞–∑–≤–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É", class: "admin-form-label" %>
          <%= f.text_field :name, class: "admin-form-input", placeholder: "–ù–∞–ø—Ä–∏–∫–ª–∞–¥: ESP LTD EC-1000..." %>
        </div>

        <div>
          <%= f.label :price, "–¶—ñ–Ω–∞ (‚Ç¥)", class: "admin-form-label" %>
          <%= f.number_field :price, step: 0.01, class: "admin-form-input font-mono", placeholder: "0.00" %>
        </div>

        <div>
          <%= f.label :quantity, "–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–∞ —Å–∫–ª–∞–¥—ñ", class: "admin-form-label" %>
          <%= f.number_field :quantity, class: "admin-form-input font-mono", placeholder: "0" %>
        </div>

        <div class="md:col-span-2">
          <%= f.label :description, "–û–ø–∏—Å", class: "admin-form-label" %>
          <%= f.text_area :description, rows: 5, class: "admin-form-input resize-none", placeholder: "–î–µ—Ç–∞–ª—å–Ω—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏..." %>
        </div>

        <%# –¢–ï–ì–ò %>
        <div class="md:col-span-2 space-y-4">
          <label class="admin-form-label">–¢–µ–≥–∏ —Ç–∞ –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó</label>
          <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 bg-stone-950 p-4 rounded-xl border border-stone-800">
            <%= f.collection_check_boxes :tag_ids, Tag.all, :id, :name do |b| %>
              <label class="flex items-center gap-3 text-xs font-bold text-stone-400 cursor-pointer group hover:text-primary transition-colors">
                <%= b.check_box class: "w-4 h-4 rounded border-stone-700 bg-stone-800 text-primary focus:ring-primary focus:ring-offset-stone-900 transition-all" %>
                <%= b.label %>
              </label>
            <% end %>
          </div>
        </div>
      </div>

      <div class="flex flex-col sm:flex-row gap-4 pt-8 border-t border-stone-800">
        <%= f.submit item.new_record? ? "–°–¢–í–û–†–ò–¢–ò –¢–û–í–ê–† ü§ò" : "–û–ù–û–í–ò–¢–ò –¢–û–í–ê–† ‚ú®", 
            class: "btn-primary flex-[2] !py-4 text-base md:text-lg tracking-widest cursor-pointer shadow-xl" %>
        
        <%= link_to "–°–ö–ê–°–£–í–ê–¢–ò", admin_items_path, 
            class: "flex-1 px-6 py-4 border-2 border-stone-700 text-stone-500 hover:text-white hover:border-stone-500 rounded-xl font-bold transition-all text-center flex items-center justify-center uppercase text-xs" %>
      </div>
    <% end %>
  </div>
</div>